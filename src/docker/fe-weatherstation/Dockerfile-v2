FROM com.gft.trainings.kubernetes-for-developers.frontend.fe-weatherstation:base

ARG GITHASH
ARG TIMESTAMP
ARG COMPONENT
ARG MODULE
ARG CUSTOMER
ARG PROJECT

ENV GITHASH=$GITHASH
ENV TIMESTAMP=$TIMESTAMP
ENV COMPONENT=$COMPONENT
ENV MODULE=$MODULE
ENV CUSTOMER=$CUSTOMER
ENV PROJECT=$PROJECT
ENV VERSION=1.0.0

USER root
RUN apk --update add curl bind-tools bash vim strace ltrace
RUN mkdir -p /workdir
RUN adduser -h /workdir ${COMPONENT} -D
RUN chown -R ${COMPONENT}:${COMPONENT} /workdir && \
    chmod -R o-rwX,g-wX,u=rwX /workdir

LABEL GITHASH=${GITHASH}
LABEL TIMESTAMP=${TIMESTAMP}
LABEL COMPONENT=${COMPONENT}
LABEL MODULE=${MODULE}
LABEL CUSTOMER=${CUSTOMER}
LABEL PROJECT=${PROJECT}
LABEL VERSION=1.0.0

USER ${COMPONENT}
WORKDIR /workdir

